(function framework7ComponentLoader(e,s){void 0===s&&(s=!0);var t=e.$,o=e.utils,p=e.getDevice,a=e.getSupport,r=(e.Class,e.Modal),l=(e.ConstructorMethods,e.ModalMethods),i=o.extend,n=o.now,c=o.getTranslate;class h extends r{constructor(e,s){const o=i({on:{}},e.params.sheet,s);super(e,o);const r=this,l=getWindow(),h=getDocument(),d=a(),m=p();let u,g,f,w;if(r.params=o,void 0===r.params.backdrop&&(r.params.backdrop="ios"!==e.theme),u=r.params.el?t(r.params.el).eq(0):t(r.params.content).filter((e=>1===e.nodeType)).eq(0),u&&u.length>0&&u[0].f7Modal)return u[0].f7Modal;if(0===u.length)return r.destroy();function y(e){const s=e.target,o=t(s);!m.desktop&&m.cordova&&(l.Keyboard&&l.Keyboard.isVisible||l.cordova.plugins&&l.cordova.plugins.Keyboard&&l.cordova.plugins.Keyboard.isVisible)||0===o.closest(r.el).length&&(r.params.closeByBackdropClick&&r.params.backdrop&&r.backdropEl&&r.backdropEl===s||r.params.closeByOutsideClick)&&r.close()}function b(e){27===e.keyCode&&r.params.closeOnEscape&&r.close()}function C(s){return(e.height-2*s)/e.height}r.params.backdrop&&r.params.backdropEl?g=t(r.params.backdropEl):r.params.backdrop&&(r.params.backdropUnique?(g=t('<div class="sheet-backdrop sheet-backdrop-unique"></div>'),r.$containerEl.append(g)):g=r.$containerEl.children(".sheet-backdrop"),0===g.length&&(g=t('<div class="sheet-backdrop"></div>'),r.$containerEl.append(g))),i(r,{app:e,push:u.hasClass("sheet-modal-push")||r.params.push,$el:u,el:u[0],$backdropEl:g,backdropEl:g&&g[0],type:"sheet",$htmlEl:t("html")}),r.params.push&&u.addClass("sheet-modal-push");let v,S,k,E,T,$,P,M,x,O,H,B,_,q,N,D,I,K,X=!1,Y=!1;function z(e){X||!r.params.swipeToClose&&!r.params.swipeToStep||r.params.swipeHandler&&0===t(e.target).closest(r.params.swipeHandler).length||(X=!0,Y=!1,v={x:"touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,y:"touchstart"===e.type?e.targetTouches[0].pageY:e.pageY},E=n(),k=void 0,$=u.hasClass("sheet-modal-top"),r.params.swipeHandler||"touchstart"!==e.type||(N=t(e.target).closest(".page-content")[0]))}function A(s){if(!X)return;if(S={x:"touchmove"===s.type?s.targetTouches[0].pageX:s.pageX,y:"touchmove"===s.type?s.targetTouches[0].pageY:s.pageY},void 0===k&&(k=!!(k||Math.abs(S.x-v.x)>Math.abs(S.y-v.y))),k)return X=!1,void(Y=!1);T=v.y-S.y;const t=T<0?"to-bottom":"to-top";if(!Y){if(N&&!u.hasClass("modal-in-swipe-step")&&(D=N.scrollTop,I=N.scrollHeight,K=N.offsetHeight,!(I===K||"to-bottom"===t&&0===D||"to-top"===t&&D===I-K)))return u.transform(""),X=!1,void(Y=!1);r.push&&w&&(_=e.$el.children(".view, .views")),O=u[0].offsetHeight,M=c(u[0],"y"),$?(H=r.params.swipeToClose?-O:-P,B=0):(H=0,B=r.params.swipeToClose?O:P),Y=!0}if(x=M-T,x=Math.min(Math.max(x,H),B),s.preventDefault(),r.push&&w){let e=(x-M)/O;r.params.swipeToStep&&(e=$?x/P:1-(P-x)/P),e=Math.abs(e),e=Math.min(Math.max(e,0),1);const s=1-e,t=1-(1-C(w))*s;_.transition(0).forEach((e=>{e.style.setProperty("transform",`translate3d(0,0,0) scale(${t})`,"important")})),r.params.swipeToStep&&_.css("border-radius",q*s+"px")}if(u.transition(0).transform(`translate3d(0,${x}px,0)`),r.params.swipeToStep){let e;e=$?1-x/P:(P-x)/P,e=Math.min(Math.max(e,0),1),u.trigger("sheet:stepprogress",e),r.emit("local::stepProgress sheetStepProgress",r,e)}}function L(){if(X=!1,!Y)return;Y=!1,u.transform("").transition(""),r.push&&w&&(_.transition("").transform(""),_.css("border-radius",""));const e=T<0?"to-bottom":"to-top",s=Math.abs(T);if(0===s||x===M)return;const t=(new Date).getTime()-E;if(!r.params.swipeToStep){if(e!==($?"to-top":"to-bottom"))return;return void((t<300&&s>20||t>=300&&s>O/2)&&r.close())}const o=$?"to-bottom":"to-top",p=$?"to-top":"to-bottom",a=Math.abs(x),l=Math.abs(P);if(t<300&&s>10)return e===o&&a<l&&(u.removeClass("modal-in-swipe-step"),u.trigger("sheet:stepprogress",1),r.emit("local::stepProgress sheetStepProgress",r,1),r.emit("local::_swipeStep",!1),u.trigger("sheet:stepopen"),r.emit("local::stepOpen sheetStepOpen",r),r.push&&w&&(r.$htmlEl[0].style.setProperty("--f7-sheet-push-scale",C(w)),_.css("border-radius",""))),e===p&&a>l&&(r.params.swipeToClose?r.close():(u.addClass("modal-in-swipe-step"),u.trigger("sheet:stepprogress",0),r.emit("local::stepProgress sheetStepProgress",r,0),r.emit("local::_swipeStep",!0),u.trigger("sheet:stepclose"),r.emit("local::stepClose sheetStepClose",r),r.push&&w&&(r.$htmlEl[0].style.removeProperty("--f7-sheet-push-scale"),_.css("border-radius","0px")))),void(e===p&&a<=l&&(u.addClass("modal-in-swipe-step"),u.trigger("sheet:stepprogress",0),r.emit("local::stepProgress sheetStepProgress",r,0),r.emit("local::_swipeStep",!0),u.trigger("sheet:stepclose"),r.emit("local::stepClose sheetStepClose",r),r.push&&w&&(r.$htmlEl[0].style.removeProperty("--f7-sheet-push-scale"),_.css("border-radius","0px"))));if(t>=300){const e=!u.hasClass("modal-in-swipe-step");e?e&&(a>l+(O-l)/2?r.params.swipeToClose&&r.close():a>l/2&&(u.addClass("modal-in-swipe-step"),u.trigger("sheet:stepprogress",0),r.emit("local::stepProgress sheetStepProgress",r,0),r.emit("local::_swipeStep",!0),u.trigger("sheet:stepclose"),r.emit("local::stepClose sheetStepClose",r),r.push&&w&&(r.$htmlEl[0].style.removeProperty("--f7-sheet-push-scale"),_.css("border-radius","0px")))):a<l/2?(u.removeClass("modal-in-swipe-step"),u.trigger("sheet:stepprogress",1),r.emit("local::stepProgress sheetStepProgress",r,1),r.emit("local::_swipeStep",!1),u.trigger("sheet:stepopen"),r.emit("local::stepOpen sheetStepOpen",r),r.push&&w&&(r.$htmlEl[0].style.setProperty("--f7-sheet-push-scale",C(w)),_.css("border-radius",""))):a-l>(O-l)/2&&r.params.swipeToClose&&r.close()}}function U(){r.setSwipeStep(!0)}r.setSwipeStep=function(e){void 0===e&&(e=!0);const s=u.find(".sheet-modal-swipe-step").eq(0);s.length&&(P=u.hasClass("sheet-modal-top")?-(s.offset().top-u.offset().top+s[0].offsetHeight):u[0].offsetHeight-(s.offset().top-u.offset().top+s[0].offsetHeight),u[0].style.setProperty("--f7-sheet-swipe-step",`${P}px`),e||(u.addClass("modal-in-swipe-step"),r.emit("local::_swipeStep",!0)))};const V=!!d.passiveListener&&{passive:!0};return(r.params.swipeToClose||r.params.swipeToStep)&&(u.on(e.touchEvents.start,z,V),e.on("touchmove",A),e.on("touchend:passive",L),r.once("sheetDestroy",(()=>{u.off(e.touchEvents.start,z,V),e.off("touchmove",A),e.off("touchend:passive",L)}))),r.on("open",(()=>{r.params.closeOnEscape&&t(h).on("keydown",b),u.prevAll(".popup.modal-in").addClass("popup-behind"),r.params.swipeToStep&&(r.setSwipeStep(!1),e.on("resize",U)),r.params.scrollToEl&&function(){const e=t(r.params.scrollToEl).eq(0);if(0===e.length)return;if(f=e.parents(".page-content"),0===f.length)return;const s=parseInt(f.css("padding-top"),10),o=parseInt(f.css("padding-bottom"),10),p=f[0].offsetHeight-s-u.height(),a=f[0].scrollHeight-s-u.height(),l=f.scrollTop();let i;const n=e.offset().top-s+e[0].offsetHeight;if(n>p){const e=l+n-p;e+p>a&&(i=e+p-a+o,p===a&&(i=u.height()),f.css({"padding-bottom":`${i}px`})),f.scrollTop(e,300)}}(),r.push&&(w=parseInt(u.css("--f7-sheet-push-offset"),10),Number.isNaN(w)&&(w=0),w&&(u.addClass("sheet-modal-push"),r.$htmlEl.addClass("with-modal-sheet-push"),r.params.swipeToStep?(_=e.$el.children(".view, .views"),q=parseFloat(u.css(`border-${$?"bottom":"top"}-left-radius`)),_.css("border-radius","0px")):r.$htmlEl[0].style.setProperty("--f7-sheet-push-scale",C(w))))})),r.on("opened",(()=>{(r.params.closeByOutsideClick||r.params.closeByBackdropClick)&&e.on("click",y)})),r.on("close",(()=>{r.params.swipeToStep&&(u.removeClass("modal-in-swipe-step"),r.emit("local::_swipeStep",!1),e.off("resize",U)),r.params.closeOnEscape&&t(h).off("keydown",b),r.params.scrollToEl&&f&&f.length>0&&f.css({"padding-bottom":""}),(r.params.closeByOutsideClick||r.params.closeByBackdropClick)&&e.off("click",y),u.prevAll(".popup.modal-in").eq(0).removeClass("popup-behind"),r.push&&w&&(r.$htmlEl.removeClass("with-modal-sheet-push"),r.$htmlEl.addClass("with-modal-sheet-push-closing"))})),r.on("closed",(()=>{r.push&&w&&(r.$htmlEl.removeClass("with-modal-sheet-push-closing"),r.$htmlEl[0].style.removeProperty("--f7-sheet-push-scale"))})),r.stepOpen=function(){u.removeClass("modal-in-swipe-step"),r.emit("local::_swipeStep",!1),r.push&&(w||(w=parseInt(u.css("--f7-sheet-push-offset"),10),Number.isNaN(w)&&(w=0)),w&&r.$htmlEl[0].style.setProperty("--f7-sheet-push-scale",C(w)))},r.stepClose=function(){u.addClass("modal-in-swipe-step"),r.emit("local::_swipeStep",!0),r.push&&r.$htmlEl[0].style.removeProperty("--f7-sheet-push-scale")},r.stepToggle=function(){u.toggleClass("modal-in-swipe-step"),r.emit("local::_swipeStep",u.hasClass("modal-in-swipe-step"))},u[0].f7Modal=r,r}}var d={name:"sheet",params:{sheet:{push:!1,backdrop:void 0,backdropEl:void 0,backdropUnique:!1,closeByBackdropClick:!0,closeByOutsideClick:!1,closeOnEscape:!1,swipeToClose:!1,swipeToStep:!1,swipeHandler:null,containerEl:null}},static:{Sheet:h},create(){const e=this;e.sheet=i({},l({app:e,constructor:h,defaultSelector:".sheet-modal.modal-in"}),{stepOpen(s){const t=e.sheet.get(s);if(t&&t.stepOpen)return t.stepOpen()},stepClose(s){const t=e.sheet.get(s);if(t&&t.stepClose)return t.stepClose()},stepToggle(s){const t=e.sheet.get(s);if(t&&t.stepToggle)return t.stepToggle()}})},clicks:{".sheet-open":function(e,s){void 0===s&&(s={});const o=this;t(".sheet-modal.modal-in").length>0&&s.sheet&&t(s.sheet)[0]!==t(".sheet-modal.modal-in")[0]&&o.sheet.close(".sheet-modal.modal-in"),o.sheet.open(s.sheet,s.animate,e)},".sheet-close":function(e,s){void 0===s&&(s={});this.sheet.close(s.sheet,s.animate,e)}}};if(s){if(e.prototype.modules&&e.prototype.modules[d.name])return;e.use(d),e.instance&&(e.instance.useModuleParams(d,e.instance.params),e.instance.useModule(d))}return d}(Framework7, typeof Framework7AutoInstallComponent === 'undefined' ? undefined : Framework7AutoInstallComponent))
