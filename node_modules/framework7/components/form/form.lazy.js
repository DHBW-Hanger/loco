(function framework7ComponentLoader(t,e){void 0===e&&(e=!0);var o=t.$,a=t.utils,r=(t.getDevice,t.getSupport,t.Class,t.Modal,t.ConstructorMethods,t.ModalMethods,a.serializeObject),n=a.extend;const s={store(t,e){const a=getWindow();let r=t;const n=o(t);n.length&&n.is("form")&&n.attr("id")&&(r=n.attr("id")),this.form.data[`form-${r}`]=e,a.localStorage[`f7form-${r}`]=JSON.stringify(e)},get(t){const e=this,a=getWindow();let r=t;const n=o(t);return n.length&&n.is("form")&&n.attr("id")&&(r=n.attr("id")),a.localStorage[`f7form-${r}`]?JSON.parse(a.localStorage[`f7form-${r}`]):e.form.data[`form-${r}`]?e.form.data[`form-${r}`]:void 0},remove(t){const e=this,a=getWindow();let r=t;const n=o(t);n.length&&n.is("form")&&n.attr("id")&&(r=n.attr("id")),e.form.data[`form-${r}`]&&(e.form.data[`form-${r}`]="",delete e.form.data[`form-${r}`]),a.localStorage[`f7form-${r}`]&&(a.localStorage[`f7form-${r}`]="",a.localStorage.removeItem(`f7form-${r}`))}},i={init(t){const e=this,a=o(t),r=a.attr("id");if(!r)return;const n=e.form.getFormData(r);n&&e.form.fillFromData(a,n),a.on("change submit",(function(){const t=e.form.convertToData(a);t&&(e.form.storeFormData(r,t),a.trigger("form:storedata",t),e.emit("formStoreData",a[0],t))}))},destroy(t){o(t).off("change submit")}};function c(t){const e=o(t).eq(0);if(0===e.length)return;const a={},r=["submit","image","button","file"],n=[];return e.find("input, select, textarea").each((t=>{const s=o(t);if(s.hasClass("ignore-store-data")||s.hasClass("no-store-data"))return;const i=s.attr("name"),c=s.attr("type"),f=t.nodeName.toLowerCase();if(!(r.indexOf(c)>=0)&&!(n.indexOf(i)>=0)&&i)if("select"===f&&s.prop("multiple"))n.push(i),a[i]=[],e.find(`select[name="${i}"] option`).each((t=>{t.selected&&a[i].push(t.value)}));else switch(c){case"checkbox":n.push(i),a[i]=[],e.find(`input[name="${i}"]`).each((t=>{t.checked&&a[i].push(t.value)}));break;case"radio":n.push(i),e.find(`input[name="${i}"]`).each((t=>{t.checked&&(a[i]=t.value)}));break;default:a[i]=s.val()}})),e.trigger("form:todata",a),this.emit("formToData",e[0],a),a}function f(t,e){const a=this,r=o(t).eq(0);if(!r.length)return;let n=e;const s=r.attr("id");if(!n&&s&&(n=a.form.getFormData(s)),!n)return;const i=["submit","image","button","file"],c=[];r.find("input, select, textarea").each((t=>{const e=o(t);if(e.hasClass("ignore-store-data")||e.hasClass("no-store-data"))return;const a=e.attr("name"),s=e.attr("type"),f=t.nodeName.toLowerCase();if(void 0!==n[a]&&null!==n[a]&&!(i.indexOf(s)>=0)&&!(c.indexOf(a)>=0)&&a){if("select"===f&&e.prop("multiple"))c.push(a),r.find(`select[name="${a}"] option`).each((t=>{const e=t;n[a].indexOf(t.value)>=0?e.selected=!0:e.selected=!1}));else switch(s){case"checkbox":c.push(a),r.find(`input[name="${a}"]`).each((t=>{const e=t;n[a].indexOf(t.value)>=0?e.checked=!0:e.checked=!1}));break;case"radio":c.push(a),r.find(`input[name="${a}"]`).each((t=>{const e=t;n[a]===t.value?e.checked=!0:e.checked=!1}));break;default:e.val(n[a])}"select"!==f&&"input"!==f&&"textarea"!==f||e.trigger("change","fromdata")}})),r.trigger("form:fromdata",n),a.emit("formFromData",r[0],n)}function m(){const t=this,e=getWindow(),a=getDocument();o(a).on("submit change","form.form-ajax-submit, form.form-ajax-submit-onchange",(function(a,n){const s=o(this);if("change"===a.type&&!s.hasClass("form-ajax-submit-onchange"))return;if("submit"===a.type&&a.preventDefault(),"change"===a.type&&"fromdata"===n)return;const i=(s.attr("method")||"GET").toUpperCase(),c=s.prop("enctype")||s.attr("enctype"),f=s.attr("action");if(!f)return;let m;m="POST"===i?"application/x-www-form-urlencoded"===c?t.form.convertToData(s[0]):new e.FormData(s[0]):r(t.form.convertToData(s[0])),t.request({method:i,url:f,contentType:c,data:m,beforeSend(e){s.trigger("formajax:beforesend",{data:m,xhr:e}),t.emit("formAjaxBeforeSend",s[0],m,e)},error(e){s.trigger("formajax:error",{data:m,xhr:e}),t.emit("formAjaxError",s[0],m,e)},complete(e){s.trigger("formajax:complete",{data:m,xhr:e}),t.emit("formAjaxComplete",s[0],m,e)},success(e,o,a){s.trigger("formajax:success",{data:m,xhr:a}),t.emit("formAjaxSuccess",s[0],m,a)}})}))}var d={name:"form",create(){const t=this;n(t,{form:{data:{},storeFormData:s.store.bind(t),getFormData:s.get.bind(t),removeFormData:s.remove.bind(t),convertToData:c.bind(t),fillFromData:f.bind(t),storage:{init:i.init.bind(t),destroy:i.destroy.bind(t)}}})},on:{init(){m.call(this)},tabBeforeRemove(t){const e=this;o(t).find(".form-store-data").each((t=>{e.form.storage.destroy(t)}))},tabMounted(t){const e=this;o(t).find(".form-store-data").each((t=>{e.form.storage.init(t)}))},pageBeforeRemove(t){const e=this;t.$el.find(".form-store-data").each((t=>{e.form.storage.destroy(t)}))},pageInit(t){const e=this;t.$el.find(".form-store-data").each((t=>{e.form.storage.init(t)}))}}};if(e){if(t.prototype.modules&&t.prototype.modules[d.name])return;t.use(d),t.instance&&(t.instance.useModuleParams(d,t.instance.params),t.instance.useModule(d))}return d}(Framework7, typeof Framework7AutoInstallComponent === 'undefined' ? undefined : Framework7AutoInstallComponent))
