(function framework7ComponentLoader(o,e){void 0===e&&(e=!0);var t=o.$,a=o.utils,r=o.getDevice,p=(o.getSupport,o.Class,o.Modal),s=(o.ConstructorMethods,o.ModalMethods),l=a.extend;class n extends p{constructor(o,e){const a=l({on:{}},o.params.popover,e);super(o,a);const p=this,s=r(),n=getWindow(),i=getDocument();let c;if(p.params=a,c=p.params.el?t(p.params.el).eq(0):t(p.params.content).filter((o=>1===o.nodeType)).eq(0),c&&c.length>0&&c[0].f7Modal)return c[0].f7Modal;const d=t(p.params.targetEl).eq(0);if(0===c.length)return p.destroy();let m;const h=p.params.backdrop&&o.$el.find(".popover.modal-in").filter((o=>o!==c[0])).length>0;let f;p.params.backdrop&&p.params.backdropEl?m=t(p.params.backdropEl):p.params.backdrop&&(p.params.backdropUnique||h?(m=t('<div class="popover-backdrop popover-backdrop-unique"></div>'),m[0].f7PopoverRef=p,p.$containerEl.append(m)):m=p.$containerEl.children(".popover-backdrop"),0===m.length&&(m=t('<div class="popover-backdrop"></div>'),p.$containerEl.append(m))),0===c.find(".popover-angle").length?(f=t('<div class="popover-angle"></div>'),c.prepend(f)):f=c.find(".popover-angle");const v=p.open;function g(){p.resize()}l(p,{app:o,$el:c,el:c[0],$targetEl:d,targetEl:d[0],$angleEl:f,angleEl:f[0],$backdropEl:m,backdropEl:m&&m[0],type:"popover",forceBackdropUnique:h,open(){for(var o=arguments.length,e=new Array(o),a=0;a<o;a++)e[a]=arguments[a];let[r,s]=e;return"boolean"==typeof e[0]&&([s,r]=e),r&&(p.$targetEl=t(r),p.targetEl=p.$targetEl[0]),v.call(p,s)}}),p.on("popoverOpen",(()=>{p.resize(),o.on("resize",g),t(n).on("keyboardDidShow keyboardDidHide",g),p.on("popoverClose popoverBeforeDestroy",(()=>{o.off("resize",g),t(n).off("keyboardDidShow keyboardDidHide",g)}))}));let u=null;function b(o){u=o.target}function k(o){const e=o.target,a=t(e);if(!(!s.desktop&&s.cordova&&(n.Keyboard&&n.Keyboard.isVisible||n.cordova.plugins&&n.cordova.plugins.Keyboard&&n.cordova.plugins.Keyboard.isVisible))&&0===a.closest(p.el).length)if(p.params.closeByBackdropClick&&p.params.backdrop&&p.backdropEl&&p.backdropEl===e&&u===e)p.close();else if(p.params.closeByOutsideClick&&u===e){const o=a.hasClass("popover-backdrop-unique")&&e.f7PopoverRef!==p||a.hasClass("popover-backdrop")&&e!==p.backdropEl,t=e.closest(".popover")&&e.closest(".popover")!==p.$el[0];o||t||p.close()}}function y(o){27===o.keyCode&&p.params.closeOnEscape&&p.close()}return p.params.closeOnEscape&&(p.on("popoverOpen",(()=>{t(i).on("keydown",y)})),p.on("popoverClose",(()=>{t(i).off("keydown",y)}))),p.on("popoverOpened",(()=>{(p.params.closeByOutsideClick||p.params.closeByBackdropClick)&&(o.on("touchstart",b),o.on("click",k))})),p.on("popoverClose",(()=>{(p.params.closeByOutsideClick||p.params.closeByBackdropClick)&&(o.off("touchstart",b),o.off("click",k))})),c[0].f7Modal=p,p}resize(){const o=this,{app:e,$el:a,$targetEl:r,$angleEl:p}=o,{targetX:s,targetY:l,verticalPosition:n}=o.params;a.css({left:"",top:""});const[i,c]=[a.width(),a.height()];let d,m,h,f,v,g,u=0;"ios"===e.theme||"aurora"===e.theme?(p.removeClass("on-left on-right on-top on-bottom").css({left:"",top:""}),u=p.width()/2):a.removeClass("popover-on-left popover-on-right popover-on-top popover-on-bottom popover-on-middle").css({left:"",top:""});let b=parseInt(t("html").css("--f7-safe-area-top"),10),k=parseInt(t("html").css("--f7-safe-area-left"),10),y=parseInt(t("html").css("--f7-safe-area-right"),10);if(Number.isNaN(b)&&(b=0),Number.isNaN(k)&&(k=0),Number.isNaN(y)&&(y=0),r&&r.length>0){h=r.outerWidth(),f=r.outerHeight();const o=r.offset();v=o.left-e.left,g=o.top-e.top;const t=r.parents(".page");t.length>0&&(g-=t[0].scrollTop)}else void 0!==s&&"undefined"!==l&&(v=s,g=l,h=o.params.targetWidth||0,f=o.params.targetHeight||0);let[E,C,M]=[0,0,0];const $="auto"!==n&&n;let w=$||("md"===e.theme?"bottom":"top");if("md"===e.theme){let o;"bottom"===$||!$&&c<e.height-g-f?(w="bottom",C=g+f):"top"===$||!$&&c<g-b?(C=g-c,w="top"):(w="middle",C=f/2+g-c/2),C=Math.max(8,Math.min(C,e.height-c-8)),v<e.width/2?(o="right",E="middle"===w?v+h:v):(o="left",E="middle"===w?v-i:v+h-i),E=Math.max(8,Math.min(E,e.width-i-8-y),k),a.addClass(`popover-on-${w} popover-on-${o}`)}else"top"===$||!$&&c+u<g-b?C=g-c-u:"bottom"===$||!$&&c+u<e.height-g-f?(w="bottom",C=g+f+u):(w="middle",C=f/2+g-c/2,M=C,C=Math.max(5,Math.min(C,e.height-c-5)),M-=C),"top"===w||"bottom"===w?(E=h/2+v-i/2,M=E,E=Math.max(5,Math.min(E,e.width-i-5)),k&&(E=Math.max(E,k)),y&&E+i>e.width-5-y&&(E=e.width-5-y-i),"top"===w&&p.addClass("on-bottom"),"bottom"===w&&p.addClass("on-top"),M-=E,d=i/2-u+M,d=Math.max(Math.min(d,i-2*u-13),13),p.css({left:`${d}px`})):"middle"===w&&(E=v-i-u,p.addClass("on-right"),(E<5||E+i+y>e.width||E<k)&&(E<5&&(E=v+h+u),E+i+y>e.width&&(E=e.width-i-5-y),E<k&&(E=k),p.removeClass("on-right").addClass("on-left")),m=c/2-u+M,m=Math.max(Math.min(m,c-2*u-13),13),p.css({top:`${m}px`}));a.css({top:`${C}px`,left:`${E}px`})}}var i={name:"popover",params:{popover:{verticalPosition:"auto",backdrop:!0,backdropEl:void 0,backdropUnique:!1,closeByBackdropClick:!0,closeByOutsideClick:!0,closeOnEscape:!1,containerEl:null}},static:{Popover:n},create(){const o=this;o.popover=l(s({app:o,constructor:n,defaultSelector:".popover.modal-in"}),{open(e,a,r){let p=t(e);if(p.length>1){const o=t(a).parents(".page");o.length&&p.each((e=>{const a=t(e);a.parents(o)[0]===o[0]&&(p=a)}))}p.length>1&&(p=p.eq(p.length-1));let s=p[0].f7Modal;const l=p.dataset();return s||(s=new n(o,Object.assign({el:p,targetEl:a},l))),s.open(a,r)}})},clicks:{".popover-open":function(o,e){void 0===e&&(e={});this.popover.open(e.popover,o,e.animate)},".popover-close":function(o,e){void 0===e&&(e={});this.popover.close(e.popover,e.animate,o)}}};if(e){if(o.prototype.modules&&o.prototype.modules[i.name])return;o.use(i),o.instance&&(o.instance.useModuleParams(i,o.instance.params),o.instance.useModule(i))}return i}(Framework7, typeof Framework7AutoInstallComponent === 'undefined' ? undefined : Framework7AutoInstallComponent))
